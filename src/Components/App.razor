<!DOCTYPE html>
<html lang="en">

<head>
    <title>BlazorSecretManager</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <base href="/"/>
    <link rel="stylesheet" href="@Assets["lib/bootstrap/dist/css/bootstrap.min.css"]"/>
    <link rel="stylesheet" href="@Assets["app.css"]"/>
    <link rel="stylesheet" href="@Assets["BlazorSecretManager.styles.css"]"/>
    <ImportMap/>
    <link rel="icon" type="image/png" href="favicon.png"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>
    <link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet"/>
    <link id="mudex-styles" href="_content/MudBlazor.Extensions/mudBlazorExtensions.min.css" rel="stylesheet">
    <HeadOutlet @rendermode="new InteractiveServerRenderMode(prerender: true)"/>
</head>

<body>
<Routes @rendermode="new InteractiveServerRenderMode(prerender: false)"/>
<script src="_framework/blazor.web.js"></script>
<script src="_content/MudBlazor/MudBlazor.min.js"></script>
<script src="_content/BlazorTrivialJs/trivial.min.js"></script>
<script type="text/javascript">
    window.initializeDraggablePopup = (popupId) => {
        let popup = document.getElementById(popupId);
        let header = document.getElementById(popupId + "-header");

        header.onmousedown = function (e) {
            startDrag(e, popup);
        };
    };

    function startDrag(e, popup) {
        e.preventDefault();
        let pos1 = 0, pos2 = 0, pos3 = e.clientX, pos4 = e.clientY;

        document.onmousemove = function (event) {
            event.preventDefault();
            pos1 = pos3 - event.clientX;
            pos2 = pos4 - event.clientY;
            pos3 = event.clientX;
            pos4 = event.clientY;
            popup.style.top = (popup.offsetTop - pos2) + "px";
            popup.style.left = (popup.offsetLeft - pos1) + "px";
        };

        document.onmouseup = function () {
            document.onmousemove = null;
            document.onmouseup = null;
        };
    }

    // 🎯 리사이즈 기능 추가
    window.initializeResizablePopup = (popupId) => {
        let popup = document.getElementById(popupId);
        let resizer = document.getElementById(popupId + "-resizer");

        resizer.onmousedown = function (e) {
            startResize(e, popup);
        };
    };

    function startResize(e, popup) {
        e.preventDefault();
        let startX = e.clientX;
        let startY = e.clientY;
        let startWidth = popup.offsetWidth;
        let startHeight = popup.offsetHeight;

        document.onmousemove = function (event) {
            event.preventDefault();
            let newWidth = startWidth + (event.clientX - startX);
            let newHeight = startHeight + (event.clientY - startY);

            if (newWidth > 200) popup.style.width = newWidth + "px";
            if (newHeight > 150) popup.style.height = newHeight + "px";
        };

        document.onmouseup = function () {
            document.onmousemove = null;
            document.onmouseup = null;
        };
    }

    window.preventEnterInTextarea = function (elementId) {
        document.getElementById(elementId).addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                event.preventDefault();
            }
        });
    };
</script>
</body>

</html>